<!DOCTYPE html>
<html lang="en">
<head>
          <title>bharadwaj.machiraju</title>
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta charset="utf-8" />
        <link href="https://tunnelshade.in/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="bharadwaj.machiraju Full Atom Feed" />


    <meta name="tags" content="tools" />


        <!-- CSS -->
        <link rel="stylesheet" href="https://unpkg.com/purecss@1.0.0/build/pure-min.css" integrity="sha384-nn4HPE8lTHyVtfCBi5yW9d20FjT8BJwUXyWZT9InLYax14RDjBj46LmSztkmNP9w" crossorigin="anonymous">
        <link rel="stylesheet" href="https://unpkg.com/purecss@1.0.0/build/grids-responsive-min.css" integrity="sha384-b92sF+wDNTHrfEtRaYo+EpcA8FUyHOSXrdxKc9XB9kaaX1rSQAgMevW6cYeE5Bdv" crossorigin="anonymous">
        <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">
        <link rel="stylesheet" href="https://tunnelshade.in/theme/css/main.css">
        <!-- End CSS -->
  <link rel="stylesheet" href="https://tunnelshade.in/theme/css/blog.css">

        <!-- Google Analytics -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
       m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
         })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-40078808-2', 'tunnelshade.in');
  ga('send', 'pageview');
</script></head>

<body id="index" class="home">
  <br>
  <div class="pure-g">
    <div class="pure-u-2-24"></div>
    <div class="pure-u-20-24">
      <div class="pure-g">
        <div class="pure-u-md-20-24 pure-u-lg-20-24 pure-u-sm-24-24" style="display: flex; align-items: center;">
            <h1>
              <a href="https://tunnelshade.in/">bharadwaj.machiraju </a>   &raquo; <a href="https://tunnelshade.in/blog/index.html">Blog</a> <a href="https://tunnelshade.in/feeds/all.atom.xml"><i class="fa fa-rss"></i></a>
            </h1>
        </div>
        <div class="pure-u-md-4-24 pure-u-lg-4-24 pure-u-sm-0-24" style="display: flex; align-items: center;">
          <img class="logo" src="https://tunnelshade.in/theme/images/logo.png"/>
        </div>
      </div>
      <br>
      <hr>
      <br>
      <div class="pure-g">
  <div class="pure-g">
    <div class="pure-u-1 pure-u-md-4-5 pure-u-lg-4-5 pure-u-xl-4-5">
<section id="content" class="body">
  <header class="pure-g"><div class="pure-u-1">
    <h2 class="entry-title">
      <a href="https://tunnelshade.in/blog/2015/08/raspberry-pi-as-music-server/" rel="bookmark"
         title="Permalink to RPi 2 as my music server">RPi 2 as my music server</a></h2>
  </div></header>
  <footer class="pure-g"><div class="pure-u-1">

    <time class="published" datetime="2015-08-19T00:00:00+05:30">
      [19-08-15]
    </time>

    [<a href="/category/linux/">Linux</a>]

    [tools]

  </div></footer><!-- /.post-info -->
  <div class="pure-g"><div class="pure-u-1">
    <p>Almost everyone is familiar with what <a href="https://www.raspberrypi.org">Raspberry Pi</a> is, if you are not aware of it better stop reading! When Pi2 was
<a href="https://www.raspberrypi.org/blog/raspberry-pi-2-on-sale/">released</a> with some great upgrades I got one to just tinker with it. Couldn't do much with it until recently. I joined my first full time role at a
company, so I spend approx. 6 hours of a weekday at office.</p>
<p>I have my work laptop and then my personal MBPR, syncing music between these is a pain. Sometimes I just want to lay back and browse through my music
collection(AFK time). I have a 2.1 speaker set which I usually connect to my laptop when I wish to listen to some music (All the time!)</p>
<h3>Things I have</h3>
<ul>
<li><strong>2.1 Speaker System</strong></li>
<li><strong>Raspberry Pi 2</strong></li>
<li>Home WiFi Network</li>
</ul>
<h3>Solution</h3>
<p><a href="http://www.musicpd.org/"><strong>MPD</strong></a> or Music Player Daemon is a best fit solution for my problem. All my music will be on some kind of memory storage accessible to pi2. If I run
mpd on the pi2 connect my speakers to it and I can just connect to it using <a href="http://ncmpcpp.rybczak.net/"><strong>NCMPCPP</strong></a> on my laptops while in my home network. If I am at office,
I can still stream my music collection to my office laptop over a vpn. One good side effect is that there are good mpd client android applications like <a href="https://play.google.com/store/apps/details?id=com.namelessdev.mpdroid&amp;hl=en"><strong>MPDroid</strong></a>. This way, I have
only one place to keep my songs and I can enjoy them everywhere.</p>
<p>The following is a reminder for me as getting MPD to run on Pi2 is not so straightforward. I use a <a href="https://www.offensive-security.com/kali-linux-vmware-arm-image-download/">Kali Linux 2.0 image</a> on Pi.</p>
<ul>
<li>Make sure you connect your Pi in your home network with a static IP. This will allow you to save settings in your mpd clients.</li>
<li>I use Kali as a non-root user, so create an account for it.</li>
<li>
<p>Sound is disabled by default on Pi2. Install <code>alsa-utils</code> if not present and load <code>snd_bmc2835</code> module.</p>
<div class="highlight"><pre><span></span><span class="c1"># apt-get install alsa-utils</span>
<span class="c1"># modprobe snd_bcm2835</span>
</pre></div>


</li>
<li>
<p>To load this module everytime at boot, just add it to <code>/etc/modules</code>.</p>
<div class="highlight"><pre><span></span><span class="c1"># echo &quot;snd_bcm2835&quot; &amp;gt;&amp;gt; /etc/modules</span>
</pre></div>


</li>
<li>
<p>I want to run MPD under the non-root user, so this user has to be added to the <code>audio</code> group if not already present.</p>
<div class="highlight"><pre><span></span><span class="c1"># grep &quot;audio&quot; /etc/groups</span>
<span class="c1"># usermod -a -G group user</span>
</pre></div>


</li>
<li>
<p>Now, hack up the configuration of mpd. Default is present at <code>/etc/mpd.conf</code>. I prefer using it from my home directory, so copied it and edited it.
All the sections of self explainatory and I am pasting here a minified version. Make sure you create all the files and folder mentioned here and ensure
that MPD has access to write to these locations and your music directory</p>
<div class="highlight"><pre><span></span>music_directory     <span class="s2">&quot;/home/tunnelshade/Music&quot;</span>
playlist_directory      <span class="s2">&quot;/home/tunnelshade/Music/playlists&quot;</span>
db_file         <span class="s2">&quot;/home/tunnelshade/Music/mpd/tag_cache&quot;</span>
log_file            <span class="s2">&quot;/home/tunnelshade/Music/mpd/mpd.log&quot;</span>
pid_file            <span class="s2">&quot;/home/tunnelshade/Music/mpd/pid&quot;</span>
state_file          <span class="s2">&quot;/home/tunnelshade/Music/mpd/state&quot;</span>
sticker_file                   <span class="s2">&quot;/home/tunnelshade/Music/mpd/sticker.sql&quot;</span>
user                <span class="s2">&quot;tunnelshade&quot;</span>

bind_to_address     <span class="s2">&quot;0.0.0.0&quot;</span>

port                <span class="s2">&quot;7000&quot;</span>

password                        <span class="s2">&quot;password@read,add,control,admin&quot;</span>

input <span class="o">{</span>
    plugin <span class="s2">&quot;curl&quot;</span>
<span class="o">}</span>

audio_output <span class="o">{</span>
    <span class="nb">type</span>        <span class="s2">&quot;alsa&quot;</span>
    name        <span class="s2">&quot;My ALSA Device&quot;</span>
<span class="o">}</span>

filesystem_charset      <span class="s2">&quot;UTF-8&quot;</span>
id3v1_encoding          <span class="s2">&quot;UTF-8&quot;</span>
</pre></div>


</li>
<li>
<p>And lastly, have to start MPD at every boot. If we add a service then it will start with system privilege, but there is one alternative. Add it as
a user cron after start. So, for me the cron entry will look like (<code>crontab -e</code>)</p>
<div class="highlight"><pre><span></span>@reboot mpd ~/.mpdconf
</pre></div>


</li>
<li>
<p>Just reboot and connect from your favourite devices.</p>
</li>
</ul>
<h3>Screenshots</h3>
<iframe src="https://drive.google.com/embeddedfolderview?id=0B7bSDtYJAnbPflZwbFBCYUl0eWlFOTYzLV93Y0hfaWdSeWZmcGEyN01LY1JsYmFRaUJxYzA#grid" width="100%" height="500px" frameborder="0"></iframe>
  </div></div><!-- /.entry-content -->
</section>

<div id="disqus_thread"></div>
<script>

/**
*  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
*  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/
/*
var disqus_config = function () {
this.page.url = PAGE_URL;  // Replace PAGE_URL with your page's canonical URL variable
this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
};
*/
(function() { // DON'T EDIT BELOW THIS LINE
var d = document, s = d.createElement('script');
s.src = 'https://tunnelshade.disqus.com/embed.js';
s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>    </div>
    <div class="pure-u-1 pure-u-md-1-5 pure-u-lg-1-5 pure-u-xl-1-5 blog_sidebar">
      <strong>Categories</strong>
      <ul>
          <li><a href="/category/bugs/">Bugs</a> [6]</li>
          <li><a href="/category/hacks/">Hacks</a> [2]</li>
          <li><a href="/category/information/">Information</a> [5]</li>
          <li><a href="/category/linux/">Linux</a> [7]</li>
          <li><a href="/category/python/">Python</a> [4]</li>
          <li><a href="/category/tools/">Tools</a> [12]</li>
      </ul>

      <br>

      <strong>Tags</strong>
      <ul>
          <li><a href="/tag/reversing/">reversing</a> [5]</li>
          <li><a href="/tag/tools/">tools</a> [11]</li>
          <li><a href="/tag/fuzzing/">fuzzing</a> [3]</li>
          <li><a href="/tag/afl/">afl</a> [2]</li>
          <li><a href="/tag/tricks/">tricks</a> [11]</li>
          <li><a href="/tag/info/">info</a> [12]</li>
          <li><a href="/tag/python/">python</a> [3]</li>
          <li><a href="/tag/hacks/">hacks</a> [5]</li>
          <li><a href="/tag/conference/">conference</a> [2]</li>
          <li><a href="/tag/linux/">linux</a> [5]</li>
          <li><a href="/tag/owtf/">owtf</a> [3]</li>
          <li><a href="/tag/screenshots/">screenshots</a> [3]</li>
      </ul>

      <br>

      <strong>Author</strong>
<ul class="no_bullets">
    <li><a class="no_underline" href="https://twitter.com/tunnelshade_"><i class="fa fa-twitter"></i> @tunnelshade_</a></li>
    <li><a class="no_underline" href="https://github.com/tunnelshade"><i class="fa fa-github"></i> Github</a></li>
    <li><a class="no_underline" href="https://in.linkedin.com/pub/bharadwaj-machiraju/45/109/38/"><i class="fa fa-linkedin"></i> LinkedIn</a></li>
    <li><a class="no_underline" href="domain_without_tld@gmail.com"><i class="fa fa-envelope"></i> domain_without_tld@gmail.com</a></li>
</ul>
    </div>
  </div>
      </div>
    </div>
    <div class="pure-u-2-24"></div>
  </div>
</body>
</html>